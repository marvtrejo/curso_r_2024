"0","# Cargamos la base de subsidios y hacemos las modificaciones al formato para crear una variable ID compatible con los archivos geojson"
"0",""
"0","subsidios_cp23<-read.csv(""Datos/Subsidios_CP23.csv"", "
"0","                         fileEncoding = ""ISO-8859-1"") %>% "
"0","  mutate(ID_ENTIDAD_FEDERATIVA = str_pad(ID_ENTIDAD_FEDERATIVA,"
"0","                                         width = 2,"
"0","                                         side = ""left"","
"0","                                         pad = ""0"")) %>% "
"0","  mutate(ID_MUNICIPIO = str_pad(ID_MUNICIPIO,"
"0","                                         width = 3,"
"0","                                         side = ""left"","
"0","                                         pad = ""0"")) %>% "
"0","  mutate(idgeo = str_c(ID_ENTIDAD_FEDERATIVA,ID_MUNICIPIO)) %>% "
"0","  mutate(mod = substr(MODALIDAD_PP,1,1))"
"0",""
"0","sub_cp23 <- aggregate(subsidios_cp23$MONTO_EJERCIDO,"
"0","                      list(subsidios_cp23$idgeo), sum)"
"0",""
"0","# A continuación cargamos la información de polígono de estados y municipios: "
"0",""
"0","# Polígono de estados"
"0","shp_ent <- st_read(""https://raw.githubusercontent.com/JuveCampos/Shapes_Resiliencia_CDMX_CIDE/master/geojsons/Division%20Politica/DivisionEstatal.geojson"")"
"1","Reading layer `"
"1","DivisionEstatal"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","https://raw.githubusercontent.com/JuveCampos/Shapes_Resiliencia_CDMX_CIDE/master/geojsons/Division%20Politica/DivisionEstatal.geojson"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","Simple feature collection with 32 features and 7 fields"
"1","
"
"1","Geometry type: POLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -117.1264 ymin: 14.53401 xmax: -86.74038 ymax: 32.71877"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","# Polígono de municipios"
"0","shp <- st_read(""Datos/S07/municipios_2022.geojson"")  %>% "
"0","  mutate(CVEGEO = str_pad(CVEGEO, "
"0","                          width = 5, "
"0","                          side = ""left"", "
"0","                          pad = ""0""))"
"1","Reading layer `"
"1","municipios_2022"
"1","' from data source "
"1","
"
"1","  "
"1","`"
"1","C:\Users\mitrejo\Mi unidad\SPPC\Github\curso_r_2024\Datos\S07\municipios_2022.geojson"
"1","' "
"1","
"
"1","  "
"1","using driver `"
"1","GeoJSON"
"1","'"
"1","
"
"1","Simple feature collection with 2475 features and 5 fields"
"1","
"
"1","Geometry type: MULTIPOLYGON
"
"1","Dimension:     XY
"
"1","Bounding box:  "
"1","xmin: -118.3652 ymin: 14.5321 xmax: -86.71063 ymax: 32.71865"
"1","
"
"1","Geodetic CRS:  WGS 84
"
"0","# Por último, unimos los datos de presupuesto y los polígonos de municipios"
"0","map_subsidios <- left_join(shp,sub_cp23, by = c(""CVEGEO"" = ""Group.1"")) %>%"
"0","  mutate(x = x/1000000)"
"0","#   %>%  mutate(nivel_pres = case_when("
"0","#    x < 24.8 ~ ""Menor a 24.8 MDP"","
"0","#    between(x, 24.8, 59.4) ~ ""Entre 24.8 y 59.4 MDP"","
"0","#    between(x, 59.4, 116.6) ~ ""Entre 59.4 y 116.6 MDP"","
"0","#    between(x, 116.6, 257.2) ~ ""Entre 116.6 y 257.2 MDP"","
"0","#    x > 257.2 ~ ""Mayor a 257.2 MDP""))"
"0",""
"0","quantile(map_subsidios$x,c(0.20, 0.40, 0.60, 0.80, 1), na.rm=T)"
"1","        20% "
"1","        40% "
"1","        60% "
"1","        80% "
"1","       100% "
"1","
"
"1","   24.76634 "
"1","   59.37098 "
"1","  116.55769 "
"1","  257.20414 "
"1","17183.41052 "
"1","
"
